{% extends 'base_admin.html.twig' %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('styles/admin_panel/panel_classement.css') }}">
{% endblock %}


{% block body %}
    <h1 class="mb-4">Mise à jour du classement</h1>
    <p>Gérez ici le classement des équipes.</p>

    <!-- Tableau des équipes -->
    <div class="table-responsive">
        <table class="table table-striped table-bordered">
            <thead class="table-dark">
                <tr>
                    <th>Logo</th>
                    <th>Nom de l'équipe</th>
                    <th>Points</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody id="teamsTable">
                {% for team in teams %}
                    <tr>
                        <td class="text-center">
                            <img src="{{ asset(team.logo) }}" alt="Logo" width="50" height="50" class="rounded-circle">
                        </td>
                        <td>{{ team.name }}</td>
                        <td>{{ team.points }}</td>
                        <td>
                            <!-- Appel de la fonction JavaScript -->
                            <button class="btn btn-primary btn-sm" onclick="editTeam('{{ loop.index0 }}', '{{ team.name }}', '{{ team.points }}')">
                                <i class="fas fa-edit"></i> Modifier
                            </button>
                            <form action="{{ path('admin_delete_team', {'index': loop.index0}) }}" method="post" style="display:inline;">
                                <button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Êtes-vous sûr de vouloir supprimer cette équipe ?');">
                                    <i class="fas fa-trash"></i> Supprimer
                                </button>
                            </form>
                        </td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="d-flex justify-content-center">
        <div class="card mt-5">
            <div class="card-header bg-dark text-white">
                <h2 id="formTitle" class="mb-0">Ajouter une équipe</h2>
            </div>
            <div class="card-body">
                <form id="teamForm" action="{{ path('admin_update_ranking') }}" method="post" enctype="multipart/form-data">
                    <input type="hidden" id="teamIndex" name="teamIndex" value="">
    
                    <div class="mb-3">
                        <label for="teamName" class="form-label">Nom de l'équipe :</label>
                        <input type="text" id="teamName" name="teamName" class="form-control" required>
                    </div>
    
                    <div class="mb-3">
                        <label for="teamLogo" class="form-label">Logo de l'équipe :</label>
                        <input type="file" id="teamLogo" name="teamLogo" class="form-control" accept="image/*">
                    </div>
    
                    <div class="mb-3">
                        <label for="teamPoints" class="form-label">Points :</label>
                        <input type="number" id="teamPoints" name="teamPoints" class="form-control" required>
                    </div>
    
                    <button type="submit" class="btn btn-primary w-100">
                        <i class="fas fa-save"></i> Enregistrer
                    </button>
                </form>
            </div>
        </div>
    </div>
    

    <!-- JavaScript -->
    <script>
        function editTeam(index, name, points) {
            // Remplir les champs du formulaire avec les informations existantes
            document.getElementById('teamIndex').value = index;
            document.getElementById('teamName').value = name;
            document.getElementById('teamPoints').value = points;

            // Modifier le titre pour indiquer qu'on est en mode édition
            document.getElementById('formTitle').innerText = 'Modifier une équipe';
        }
    </script>
{% endblock %}
